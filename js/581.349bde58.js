"use strict";(self["webpackChunkcloud_music"]=self["webpackChunkcloud_music"]||[]).push([[581],{1399:function(t,s,e){e.d(s,{Z:function(){return c}});var i=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],ref:"listCard",staticClass:"listCard",attrs:{"infinite-scroll-disabled":t.disabled,"infinite-scroll-distance":300,"infinite-scroll-immediate":!1}},t._l(t.listCardData,(function(e,i){return s("div",{key:i,staticClass:"listCardItem",on:{click:function(s){return t.clickListCardItem(e.id)}}},[s("div",{staticClass:"image"},[s("img",{attrs:{src:(e.picUrl||e.coverImgUrl)+"?param=400y400",alt:""}})]),s("div",{staticClass:"title"},[t._v(t._s(e.name))])])})),0)},a=[],r={name:"ListCard",props:{listCardData:{type:Array,default(){return[]}},isLoad:{type:Boolean,default(){return!1}}},data(){return{disabled:!0}},methods:{clickListCardItem(t){this.$emit("clickListCardItem",t)},load(){this.$emit("bottomLoad"),this.disabled=!0}},watch:{listCardData(){1==this.isLoad&&(0!=this.listCardData.length?this.disabled=!1:this.disabled=!0)}}},n=r,l=e(1001),o=(0,l.Z)(n,i,a,!1,null,"a4cfd9ea",null),c=o.exports},2581:function(t,s,e){e.r(s),e.d(s,{default:function(){return d}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"Personal"},[t.userInfo.avatarUrl?s("div",{staticClass:"userInfo"},[s("div",{staticClass:"left"},[s("img",{staticClass:"avatar",attrs:{src:t.userInfo.avatarUrl+"?param=400y400",alt:""}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"rightTop"},[s("div",{staticClass:"username"},[s("div",[t._v(t._s(t.userInfo.nickname))]),t.isCurrentUser&&this.$store.state.isLogin?s("div",{staticClass:"logout",on:{click:t.logout}},[s("i",{staticClass:"iconfont icon-zhuxiao1"}),s("span",[t._v("退出登录")])]):t._e()]),s("div",{staticClass:"tags"},[s("div",{staticClass:"level"},[t._v(t._s("Lv"+t.userInfo.level))]),s("div",{staticClass:"gender"})])]),s("div",{staticClass:"rightBottom"},[s("div",{staticClass:"dataNums"},[s("div",{staticClass:"numItem"},[s("div",{staticClass:"numItemTop"},[t._v(t._s(t.userInfo.eventCount))]),s("div",{staticClass:"numItemBottom"},[t._v("动态")])])]),s("div",{staticClass:"otherInfo"},[s("div",{staticClass:"otherInfoItem"},[s("div",{staticClass:"otherInfoKey"},[t._v("用户id：")]),s("div",{staticClass:"ptherInfoValue"},[t._v(t._s(t.userInfo.userId))])]),s("div",{staticClass:"otherInfoItem"},[s("div",{staticClass:"otherInfoKey"},[t._v("所在地区：")]),s("div",{staticClass:"ptherInfoValue"},[t._v(" "+t._s(t.userInfo.province+" "+t.userInfo.city)+" ")])]),s("div",{staticClass:"otherInfoItem"},[s("div",{staticClass:"otherInfoKey"},[t._v("个人介绍：")]),s("div",{staticClass:"ptherInfoValue"},[t._v(" "+t._s(""==t.userInfo.signature?"暂无介绍":t.userInfo.signature)+" ")])])])])])]):t._e(),s("div",{staticClass:"musicList"},[0!=t.createdMusicList.length?s("div",{staticClass:"musicListTitle"},[t._v(" "+t._s(t.userInfo.nickname)+"创建的歌单("+t._s(t.createdMusicList.length)+") ")]):t._e(),s("list-card",{attrs:{listCardData:t.createdMusicList},on:{clickListCardItem:t.clickListCardItem}}),0!=t.collectedMusicList.length?s("div",{staticClass:"musicListTitle"},[t._v(" "+t._s(t.userInfo.nickname)+"收藏的歌单("+t._s(t.collectedMusicList.length)+") ")]):t._e(),s("list-card",{attrs:{listCardData:t.collectedMusicList},on:{clickListCardItem:t.clickListCardItem}})],1)])},a=[],r=(e(7658),e(1399)),n=e(3214),l={components:{ListCard:r.Z},name:"Personal",data(){return{userInfo:{},createdMusicList:[],collectedMusicList:[],isCurrentUser:!1}},methods:{async getUserInfo(){let t=await this.$request(`/user/detail?uid=${this.$route.params.uid}`);t?(t.data.profile["level"]=t.data.level,this.userInfo=t.data.profile):this.$message.error("获取用户信息失败!")},async getUserMusicList(){let t=Date.parse(new Date),s=await this.$request("/user/playlist",{uid:this.$route.params.uid,timestamp:t});console.log(s),s=s.data.playlist;let e=s.findIndex((t=>1==t.subscribed));s[0].name=`${this.userInfo.nickname}喜欢的音乐`,this.createdMusicList=s.slice(0,e),this.collectedMusicList=s.slice(e)},clickListCardItem(t){this.$router.push({name:"musicListDetail",params:{id:t}})},async logout(){let t=await this.$request("/logout",{timestamp:(0,n.dg)()});200==t.data.code?(window.localStorage.removeItem("userId"),this.$store.commit("updataLoginState",!1),this.$message.success("退出成功!"),this.isCurrentUser=!1,this.$router.push({name:"/discover/recommend"})):this.$message("退出登录失败, 请稍后重试!")}},watch:{"$store.state.isLogin"(t){window.localStorage.getItem("userId")&&t&&(this.isCurrentUser=window.localStorage.getItem("userId")==this.$route.params.uid)}},async created(){await this.getUserInfo(),this.getUserMusicList(),window.localStorage.getItem("userId")&&(this.isCurrentUser=window.localStorage.getItem("userId")==this.$route.params.uid)}},o=l,c=e(1001),u=(0,c.Z)(o,i,a,!1,null,"4c6e1895",null),d=u.exports},3214:function(t,s,e){function i(t){t=parseInt(t),t=t>1e4?Math.floor(t/1e3):Math.floor(t);let s=Math.floor(t/60),e=Math.floor(t%60);return s=s<10?"0"+s:s,e=e<10?"0"+e:e,s+":"+e}function a(){return Date.now()}function r(t){t=t.split(":");let s=parseInt(t[0]),e=parseInt(t[1]);return 60*s+e}function n(t,s){/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));let e={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(let i in e)if(new RegExp(`(${i})`).test(s)){let t=e[i]+"";s=s.replace(RegExp.$1,1===RegExp.$1.length?t:o(t))}return s}function l(t){return t>1e4?(t=(t/1e4).toFixed(1),t+"万"):t}function o(t){return("00"+t).substr(t.length)}e.d(s,{J4:function(){return r},dg:function(){return a},oF:function(){return i},p6:function(){return n},xw:function(){return l}})}}]);
//# sourceMappingURL=581.349bde58.js.map